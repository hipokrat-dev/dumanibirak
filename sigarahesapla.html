<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sigara Risk Hesaplayıcı ve Simülasyonu</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #0f172a; color: #eee; }
        
        /* Range Slider Özelleştirme */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #ef4444;
            cursor: pointer;
            margin-top: -8px;
            border: 2px solid #fff;
            box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 6px;
            cursor: pointer;
            background: #334155;
            border-radius: 3px;
        }
        
        /* Kart Stilleri */
        .glass-panel {
            background: #1e293b;
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        
        /* Küçültülmüş Vizüel Alan */
        #viz-container {
            width: 100%;
            height: 350px; /* Yükseklik azaltıldı */
            position: relative;
            border-radius: 1rem;
            overflow: hidden;
            background: radial-gradient(circle at center, #1e293b 0%, #020617 100%);
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* Akciğer SVG Stilleri */
        svg {
            height: 85%;
            width: auto;
            filter: drop-shadow(0 0 20px rgba(0,0,0,0.5));
            transition: transform 0.3s ease-out;
        }

        .breathing {
            animation: breathAnim 3s ease-in-out infinite;
            transform-origin: center bottom;
        }

        @keyframes breathAnim {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .smoke-container {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 10;
        }
        .smoke-particle {
            position: absolute;
            bottom: -50px;
            background: radial-gradient(circle, rgba(200,200,200,0.4) 0%, rgba(255,255,255,0) 70%);
            border-radius: 50%;
            animation: floatUp 4s linear infinite;
        }
        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            20% { opacity: 0.6; }
            100% { transform: translateY(-400px) scale(3); opacity: 0; }
        }
        
        .stat-card {
            background: rgba(30, 41, 59, 0.7);
            border: 1px solid rgba(255,255,255,0.05);
            transition: transform 0.2s;
        }
        .stat-card:hover {
            transform: translateY(-2px);
            background: rgba(30, 41, 59, 1);
        }

        /* Risk Barı */
        .risk-bar-bg {
            width: 100%;
            height: 8px;
            background-color: #334155;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 4px;
        }
        .risk-bar-fill {
            height: 100%;
            background-color: #ef4444;
            width: 0%;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body class="min-h-screen p-4 md:p-8">

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <header class="mb-6 text-center md:text-left border-b border-gray-800 pb-4">
            <h1 class="text-2xl md:text-3xl font-extrabold text-white tracking-tight mb-2">
                <i class="fa-solid fa-calculator text-red-500 mr-3"></i>Sigara Risk & Maliyet Hesaplayıcı
            </h1>
            <p class="text-gray-400 text-sm max-w-2xl">
                Anatomik simülasyon, hastalık risk çarpanları ve detaylı maliyet analizi.
            </p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- SOL PANEL: Girdiler -->
            <div class="lg:col-span-4 space-y-6">
                <div class="glass-panel rounded-xl p-5">
                    <h2 class="text-lg font-bold text-white mb-4 flex items-center">
                        <i class="fa-solid fa-sliders text-blue-400 mr-2"></i> Kullanım Bilgileri
                    </h2>

                    <div class="space-y-6">
                        <!-- Input: Yıl -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-gray-300 font-medium text-sm">Kaç yıldır içiyorsunuz?</label>
                                <span class="text-red-400 font-bold bg-red-900/20 px-2 py-0.5 rounded text-sm" id="displayYears">0 Yıl</span>
                            </div>
                            <input type="range" id="inputYears" min="0" max="50" value="0" step="1">
                        </div>

                        <!-- Input: Adet -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-gray-300 font-medium text-sm">Günde kaç dal?</label>
                                <span class="text-red-400 font-bold bg-red-900/20 px-2 py-0.5 rounded text-sm" id="displayCigs">0 Dal</span>
                            </div>
                            <input type="range" id="inputCigs" min="0" max="60" value="0" step="1">
                        </div>

                        <!-- Input: Fiyat -->
                        <div>
                            <div class="flex justify-between mb-2">
                                <label class="text-gray-300 font-medium text-sm">Paket Fiyatı</label>
                                <span class="text-green-400 font-bold bg-green-900/20 px-2 py-0.5 rounded text-sm" id="displayPrice">60 ₺</span>
                            </div>
                            <input type="range" id="inputPrice" min="30" max="150" value="60" step="5">
                        </div>
                    </div>
                </div>

                <!-- Sağlık Durumu -->
                <div class="bg-red-900/20 border border-red-800/30 p-4 rounded-xl">
                    <h3 class="font-bold text-red-400 mb-1 flex items-center text-sm">
                        <i class="fa-solid fa-heart-pulse mr-2"></i> Akciğer Durumu
                    </h3>
                    <p id="healthStatus" class="text-xs text-gray-300 leading-relaxed">
                        Veri bekleniyor...
                    </p>
                </div>
            </div>

            <!-- SAĞ PANEL: Görselleştirme ve İstatistikler -->
            <div class="lg:col-span-8 space-y-6">
                
                <!-- Üst Kısım: Görsel ve Temel İstatistikler -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- 1. Görselleştirme (Daha küçük) -->
                    <div id="viz-container">
                        <div class="smoke-container" id="smokeLayer"></div>
                        <!-- SVG Akciğer -->
                        <svg viewBox="0 0 400 400" id="lungSvg" class="breathing">
                            <defs>
                                <radialGradient id="lungGradient" cx="30%" cy="30%" r="70%" fx="40%" fy="30%">
                                    <stop id="gradStop1" offset="0%" stop-color="#ffb6c1" />
                                    <stop id="gradStop2" offset="100%" stop-color="#e08e9b" />
                                </radialGradient>
                                <filter id="tarFilter">
                                    <feTurbulence type="fractalNoise" baseFrequency="0.02" numOctaves="3" result="noise" />
                                    <feColorMatrix type="matrix" values="0 0 0 0 0  0 0 0 0 0  0 0 0 0 0  0 0 0 1 0" in="noise" result="coloredNoise" />
                                    <feComposite operator="in" in="coloredNoise" in2="SourceGraphic" result="composite" />
                                    <feBlend mode="multiply" in="composite" in2="SourceGraphic" />
                                </filter>
                                <filter id="insetShadow">
                                    <feGaussianBlur in="SourceAlpha" stdDeviation="4" result="blur"/>
                                    <feOffset dx="2" dy="2"/>
                                    <feComposite in2="SourceAlpha" operator="arithmetic" k2="-1" k3="1"/>
                                    <feFlood flood-color="black" flood-opacity="0.3"/>
                                    <feComposite in2="SourceAlpha" operator="in"/>
                                    <feMerge><feMergeNode in="SourceGraphic"/><feMergeNode/></feMerge>
                                </filter>
                            </defs>
                            <!-- Trachea -->
                            <g id="trachea" transform="translate(185, 20)">
                                <path d="M0,0 L30,0 L30,80 L0,80 Z" fill="#e5e7eb" stroke="#cbd5e1" stroke-width="1"/>
                                <g stroke="#94a3b8" stroke-width="2" fill="none">
                                    <path d="M2,10 H28" /><path d="M2,20 H28" /><path d="M2,30 H28" />
                                    <path d="M2,40 H28" /><path d="M2,50 H28" /><path d="M2,60 H28" /><path d="M2,70 H28" />
                                </g>
                            </g>
                            <!-- Sol Akciğer -->
                            <g id="leftLung" transform="translate(205, 90)">
                                <path d="M10,0 C10,-20 70,-10 80,30 C95,90 90,180 80,220 C60,260 10,240 0,230 C-10,180 -10,120 10,0 Z" 
                                      fill="url(#lungGradient)" filter="url(#insetShadow)" stroke="#rgba(0,0,0,0.1)" stroke-width="1"/>
                            </g>
                            <!-- Sağ Akciğer -->
                            <g id="rightLung" transform="translate(195, 90) scale(-1, 1)">
                                <path d="M10,0 C10,-20 70,-10 85,30 C100,100 100,190 85,230 C60,265 10,240 0,230 C-10,180 -10,120 10,0 Z" 
                                      fill="url(#lungGradient)" filter="url(#insetShadow)" stroke="#rgba(0,0,0,0.1)" stroke-width="1"/>
                            </g>
                            <!-- Katran Overlay -->
                            <g id="tarOverlay" style="opacity: 0; mix-blend-mode: multiply;">
                                 <path transform="translate(205, 90)" d="M10,0 C10,-20 70,-10 80,30 C95,90 90,180 80,220 C60,260 10,240 0,230 C-10,180 -10,120 10,0 Z" 
                                       fill="#333" filter="url(#tarFilter)" />
                                 <path transform="translate(195, 90) scale(-1, 1)" d="M10,0 C10,-20 70,-10 85,30 C100,100 100,190 85,230 C60,265 10,240 0,230 C-10,180 -10,120 10,0 Z" 
                                       fill="#333" filter="url(#tarFilter)" />
                            </g>
                        </svg>
                    </div>

                    <!-- 2. Temel İstatistikler + Risk Çarpanları -->
                    <div class="flex flex-col gap-4">
                        <!-- Harcama Kartı -->
                        <div class="stat-card p-4 rounded-xl">
                            <div class="text-gray-400 text-xs uppercase font-bold mb-1">Toplam Harcama</div>
                            <div class="text-2xl font-bold text-green-400" id="statMoney">0 ₺</div>
                            <div class="text-xs text-gray-500 mt-1">
                                Bu parayla <span id="whatCouldBuy" class="text-green-200 font-semibold">...</span> alabilirdiniz.
                            </div>
                        </div>

                        <!-- Hastalık Riskleri Kartı (YENİ) -->
                        <div class="stat-card p-4 rounded-xl flex-grow flex flex-col justify-center">
                            <div class="text-gray-400 text-xs uppercase font-bold mb-3 flex justify-between">
                                <span>ARTAN HASTALIK RİSKLERİ</span>
                                <i class="fa-solid fa-triangle-exclamation text-yellow-500"></i>
                            </div>
                            
                            <!-- Risk 1: Kanser -->
                            <div class="mb-3">
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-300">Akciğer Kanseri</span>
                                    <span class="text-red-400 font-bold" id="riskCancerText">1x</span>
                                </div>
                                <div class="risk-bar-bg">
                                    <div class="risk-bar-fill" id="riskCancerBar"></div>
                                </div>
                            </div>

                            <!-- Risk 2: Kalp -->
                            <div class="mb-3">
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-300">Kalp Krizi</span>
                                    <span class="text-orange-400 font-bold" id="riskHeartText">1x</span>
                                </div>
                                <div class="risk-bar-bg">
                                    <div class="risk-bar-fill bg-orange-500" id="riskHeartBar"></div>
                                </div>
                            </div>

                            <!-- Risk 3: KOAH -->
                            <div>
                                <div class="flex justify-between text-xs mb-1">
                                    <span class="text-gray-300">KOAH Riski</span>
                                    <span class="text-yellow-400 font-bold" id="riskKoahText">1x</span>
                                </div>
                                <div class="risk-bar-bg">
                                    <div class="risk-bar-fill bg-yellow-500" id="riskKoahBar"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Alt Kısım: Detaylı Hesaplamalar (YENİ) -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    
                    <!-- Detaylı Finansal Tablo -->
                    <div class="glass-panel p-5 rounded-xl">
                        <h3 class="text-white font-bold mb-4 border-b border-gray-700 pb-2 flex items-center">
                            <i class="fa-solid fa-table-list text-green-400 mr-2"></i> Detaylı Maliyet Tablosu
                        </h3>
                        <div class="space-y-3 text-sm">
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">Aylık Harcama</span>
                                <span class="text-white font-mono" id="costMonthly">0 ₺</span>
                            </div>
                            <div class="flex justify-between items-center bg-white/5 p-2 rounded">
                                <span class="text-gray-300">Yıllık Harcama</span>
                                <span class="text-green-400 font-bold font-mono" id="costYearly">0 ₺</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">5 Yıl Sonra</span>
                                <span class="text-gray-200 font-mono" id="cost5Years">0 ₺</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-gray-400">10 Yıl Sonra</span>
                                <span class="text-gray-200 font-mono" id="cost10Years">0 ₺</span>
                            </div>
                        </div>
                    </div>

                    <!-- Bırakma Zaman Çizelgesi -->
                    <div class="glass-panel p-5 rounded-xl">
                        <h3 class="text-white font-bold mb-4 border-b border-gray-700 pb-2 flex items-center">
                            <i class="fa-solid fa-clock-rotate-left text-blue-400 mr-2"></i> Bırakırsan Ne Olur?
                        </h3>
                        <div class="space-y-4 text-xs text-gray-300">
                            <div class="flex gap-3">
                                <div class="w-12 font-bold text-blue-400">20 dk</div>
                                <div>Nabız ve kan basıncı normale döner.</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="w-12 font-bold text-blue-400">24 saat</div>
                                <div>Karbonmonoksit vücuttan atılır.</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="w-12 font-bold text-blue-400">3 ay</div>
                                <div>Akciğer kapasitesi %30'a kadar artar.</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="w-12 font-bold text-blue-400">1 yıl</div>
                                <div>Kalp krizi riski yarıya düşer.</div>
                            </div>
                            <div class="flex gap-3">
                                <div class="w-12 font-bold text-blue-400">10 yıl</div>
                                <div>Akciğer kanseri riski sigara içen birinin yarısına iner.</div>
                            </div>
                        </div>
                    </div>

                </div>

            </div>
        </div>
    </div>

    <script>
        // --- UI ELEMENTLERİ ---
        const els = {
            years: document.getElementById('inputYears'),
            cigs: document.getElementById('inputCigs'),
            price: document.getElementById('inputPrice'),
            dYears: document.getElementById('displayYears'),
            dCigs: document.getElementById('displayCigs'),
            dPrice: document.getElementById('displayPrice'),
            
            money: document.getElementById('statMoney'),
            buy: document.getElementById('whatCouldBuy'),
            status: document.getElementById('healthStatus'),
            
            // Risk Elementleri
            riskCancerText: document.getElementById('riskCancerText'),
            riskCancerBar: document.getElementById('riskCancerBar'),
            riskHeartText: document.getElementById('riskHeartText'),
            riskHeartBar: document.getElementById('riskHeartBar'),
            riskKoahText: document.getElementById('riskKoahText'),
            riskKoahBar: document.getElementById('riskKoahBar'),

            // Detaylı Maliyet Elementleri
            costMonthly: document.getElementById('costMonthly'),
            costYearly: document.getElementById('costYearly'),
            cost5Years: document.getElementById('cost5Years'),
            cost10Years: document.getElementById('cost10Years'),
            
            // SVG Elemanları
            gradStop1: document.getElementById('gradStop1'),
            gradStop2: document.getElementById('gradStop2'),
            tarOverlay: document.getElementById('tarOverlay'),
            smokeLayer: document.getElementById('smokeLayer'),
            lungSvg: document.getElementById('lungSvg')
        };

        // --- RENKLER ---
        const colorHealthy1 = {r: 255, g: 182, b: 193}; // Açık Pembe
        const colorHealthy2 = {r: 224, g: 142, b: 155}; // Koyu Pembe
        const colorSick1 = {r: 50, g: 50, b: 50}; // Koyu Gri
        const colorSick2 = {r: 20, g: 20, b: 20}; // Siyah

        function lerpColor(c1, c2, factor) {
            const r = Math.round(c1.r + (c2.r - c1.r) * factor);
            const g = Math.round(c1.g + (c2.g - c1.g) * factor);
            const b = Math.round(c1.b + (c2.b - c1.b) * factor);
            return `rgb(${r}, ${g}, ${b})`;
        }

        function updateApp() {
            const years = parseInt(els.years.value);
            const daily = parseInt(els.cigs.value);
            const price = parseInt(els.price.value);

            // UI Güncellemeleri
            els.dYears.innerText = `${years} Yıl`;
            els.dCigs.innerText = `${daily} Dal`;
            els.dPrice.innerText = `${price} ₺`;

            // --- HESAPLAMALAR ---
            const totalCigs = years * 365 * daily;
            const packs = totalCigs / 20;
            const moneyLost = packs * price;
            
            // "Paket Yılı" kavramı tıpta risk hesaplamada kullanılır
            // 1 Paket Yılı = 1 yıl boyunca günde 1 paket (20 sigara) içmek.
            const packYears = (daily / 20) * years;

            // Hasar Skoru (Görsel İçin)
            let damage = packYears / 30; // 30 paket yılı = Tam hasar
            if(damage > 1) damage = 1;

            // --- HASTALIK RİSKLERİ HESABI (Yaklaşık Tıbbi Oranlar) ---
            // Baz risk: 1x (İçmeyen biri)
            
            // 1. Akciğer Kanseri: Paket yılı arttıkça çok dik artar.
            // 20 paket yılında yaklaşık 10-15 kat artar.
            let cancerRisk = 1 + (packYears * 0.8); 
            if(cancerRisk > 30) cancerRisk = 30; // Max limit görsel için

            // 2. Kalp Krizi: Düşük dozlarda bile hızla artar.
            let heartRisk = 1 + (packYears * 0.2);
            if(heartRisk > 5) heartRisk = 5;

            // 3. KOAH: Çok yüksek korelasyon.
            let koahRisk = 1 + (packYears * 0.6);
            if(koahRisk > 20) koahRisk = 20;

            // Riskleri UI'ya Yazdır
            els.riskCancerText.innerText = cancerRisk.toFixed(1) + "x";
            els.riskCancerBar.style.width = `${(cancerRisk / 30) * 100}%`;

            els.riskHeartText.innerText = heartRisk.toFixed(1) + "x";
            els.riskHeartBar.style.width = `${(heartRisk / 5) * 100}%`;

            els.riskKoahText.innerText = koahRisk.toFixed(1) + "x";
            els.riskKoahBar.style.width = `${(koahRisk / 20) * 100}%`;

            // --- DETAYLI MALİYET HESABI ---
            const monthlyCost = (daily / 20) * 30 * price;
            const yearlyCost = monthlyCost * 12;
            
            els.costMonthly.innerText = formatMoney(monthlyCost);
            els.costYearly.innerText = formatMoney(yearlyCost);
            els.cost5Years.innerText = formatMoney(yearlyCost * 5);
            els.cost10Years.innerText = formatMoney(yearlyCost * 10);

            // --- GÖRSEL EFEKTLER ---
            const newColor1 = lerpColor(colorHealthy1, colorSick1, damage);
            const newColor2 = lerpColor(colorHealthy2, colorSick2, damage);
            
            els.gradStop1.setAttribute('stop-color', newColor1);
            els.gradStop2.setAttribute('stop-color', newColor2);
            els.tarOverlay.style.opacity = damage;

            if(daily > 0) {
                const animDuration = 3 - (damage * 2);
                els.lungSvg.style.animationDuration = `${Math.max(0.5, animDuration)}s`;
            } else {
                 els.lungSvg.style.animationDuration = `4s`;
            }

            updateSmoke(daily);

            // --- ANA İSTATİSTİKLER ---
            els.money.innerText = formatMoney(moneyLost);
            
            // Satın Alma Gücü
            if(moneyLost > 3000000) els.buy.innerText = "Lüks bir Yazlık";
            else if(moneyLost > 1500000) els.buy.innerText = "Sıfır Daire";
            else if(moneyLost > 800000) els.buy.innerText = "Premium Araba (SUV)";
            else if(moneyLost > 400000) els.buy.innerText = "İyi bir Araba";
            else if(moneyLost > 100000) els.buy.innerText = "En iyi Motosiklet";
            else if(moneyLost > 30000) els.buy.innerText = "Son Model Telefon + Laptop";
            else els.buy.innerText = "Yatırım Hesabı";

            // Durum Mesajı
            if (daily === 0) {
                els.status.innerHTML = "<span class='text-green-400'>Tertemiz.</span> Riskleriniz minimum seviyede.";
            } else if (damage < 0.3) {
                els.status.innerHTML = "<span class='text-yellow-400'>Riskler Başladı.</span> Kanser ve KOAH riski şimdiden artış eğiliminde.";
            } else if (damage < 0.7) {
                els.status.innerHTML = "<span class='text-orange-500'>Yüksek Risk.</span> Kalp krizi ve kanser riski katlanarak artıyor.";
            } else {
                els.status.innerHTML = "<span class='text-red-600 font-bold'>KRİTİK.</span> Normal bir insana göre kanser riskiniz 20 kattan fazla.";
            }
        }

        function formatMoney(amount) {
            return amount.toLocaleString('tr-TR', { maximumFractionDigits: 0 }) + " ₺";
        }

        // --- DUMAN ANİMASYONU ---
        let smokeInterval;
        function updateSmoke(daily) {
            els.smokeLayer.innerHTML = '';
            if(smokeInterval) clearInterval(smokeInterval);

            if(daily > 0) {
                const speed = Math.max(100, 1000 - (daily * 20)); 
                smokeInterval = setInterval(createSmokeParticle, speed);
            }
        }

        function createSmokeParticle() {
            const p = document.createElement('div');
            p.classList.add('smoke-particle');
            const size = 20 + Math.random() * 40;
            const left = 40 + Math.random() * 20; 
            p.style.width = `${size}px`;
            p.style.height = `${size}px`;
            p.style.left = `${left}%`;
            els.smokeLayer.appendChild(p);
            setTimeout(() => { p.remove(); }, 4000);
        }

        [els.years, els.cigs, els.price].forEach(i => i.addEventListener('input', updateApp));
        updateApp();

    </script>
</body>
</html>